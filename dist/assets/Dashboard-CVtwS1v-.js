import{u as A,r as g,a as u,i as O,b as F,c as G,f as U,j as e,B as k,T as l,P as K,I as Y,C as q,d as J,e as N,l as Q,g as V}from"./index-Bu_2AdWW.js";import{H as X,a as Z,D as ee,b as re,c as se,M as te,d as ae}from"./MatchStats-CKgCi4Tu.js";import{C as oe,G as b,a as C,b as v,T as x,c as _}from"./TablePagination-DdfTy-4p.js";import{T as ne,a as ce,b as ie,c as D,d as le}from"./TableRow-BmWPhPTE.js";import{B as I}from"./TextField-DuPoW9vl.js";import"./DataGrid-Z0Zoet1u.js";import"./Select-Bjduvh0F.js";import"./Avatar-BTScyE8V.js";import"./useSlot-jSVLBByM.js";const r={bgDark:"#0d0d0d",bgCard:"#1a1a1a",bgHover:"#252525",accent:"#de6c2c",textPrimary:"#e5e5e5",textSecondary:"#888888",border:"rgba(255,255,255,0.08)"},P={de_dust2:"/maps/dust2.png",de_mirage:"/maps/mirage.png",de_inferno:"/maps/inferno.png",de_nuke:"/maps/nuke.png",de_overpass:"/maps/overpass.png",de_ancient:"/maps/ancient.png",de_anubis:"/maps/anubis.png",de_vertigo:"/maps/vertigo.png",cs_office:"/maps/office.png",de_train:"/maps/train.png",de_cache:"/maps/cache.png"},de=o=>{if(!o)return null;const p=o.toLowerCase().replace(/\s/g,"_");return P[p]||P[`de_${p}`]||null},ke=()=>{const o=A(),[p,S]=g.useState(null),[W,y]=g.useState(!1),[$,f]=g.useState({}),j=g.useRef(!1),m=u(s=>s.stats.matches),L=u(s=>s.stats.players),H=u(s=>s.stats.months),n=u(s=>s.user.user),T=u(s=>s.user.likedMatches);g.useEffect(()=>{o(O()),o(F()),o(G())},[o]),g.useEffect(()=>{(async()=>{if(m.length>0)try{const a=m.map(d=>String(d.matchid)),t=await J.getMatchLikeCounts(a);f(t)}catch(a){console.error("Failed to fetch like counts:",a)}})()},[m.length]),g.useEffect(()=>{n!=null&&n.username&&!j.current&&o(U())},[o,n==null?void 0:n.username]);const w=async(s,a)=>{if(s.stopPropagation(),!n)return;const t=String(a),d=T.includes(t);j.current=!0,d?(o(N(t)),f(i=>{var h,c;return{...i,[t]:{count:Math.max((((h=i[t])==null?void 0:h.count)||1)-1,0),users:(((c=i[t])==null?void 0:c.users)||[]).filter(E=>E.username!==n.username)}}})):(o(Q(t)),f(i=>{var h,c;return{...i,[t]:{count:(((h=i[t])==null?void 0:h.count)||0)+1,users:[...((c=i[t])==null?void 0:c.users)||[],{username:n.username,name:n.name}]}}})),setTimeout(()=>{j.current=!1},500)},z=s=>{S(s),o(V(s.matchid,s.url)),y(!0)},M=()=>{y(!1),S(null)},R=s=>{const a=/team_(.*?)_vs_team_(.*?)(?=\.)/,t=s.match(a);return t?`${t[1]} vs ${t[2]}`:"Unknown Teams"},B=s=>{s.stopPropagation()};return e.jsx(k,{sx:{minHeight:"100vh",bgcolor:r.bgDark,color:r.textPrimary,pb:4},children:e.jsxs(oe,{maxWidth:"xl",sx:{pt:4},children:[e.jsxs(k,{sx:{mb:4},children:[e.jsx(l,{variant:"overline",sx:{color:r.accent,letterSpacing:3,fontWeight:"bold"},children:"INHOUSE STATS"}),e.jsx(l,{variant:"h3",sx:{fontWeight:800,color:r.textPrimary},children:"Rakkauden Kanaali"})]}),e.jsxs(b,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsx(C,{sx:{bgcolor:r.bgCard,border:`1px solid ${r.border}`},children:e.jsxs(v,{children:[e.jsx(l,{variant:"overline",sx:{color:r.textSecondary,letterSpacing:2},children:"Total Matches"}),e.jsx(l,{variant:"h3",sx:{color:r.accent,fontWeight:800},children:m.length})]})})}),e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsx(C,{sx:{bgcolor:r.bgCard,border:`1px solid ${r.border}`},children:e.jsxs(v,{children:[e.jsx(l,{variant:"overline",sx:{color:r.textSecondary,letterSpacing:2},children:"Total Players"}),e.jsx(l,{variant:"h3",sx:{color:r.accent,fontWeight:800},children:L.length})]})})}),e.jsx(b,{item:!0,xs:12,sm:4,children:e.jsx(C,{sx:{bgcolor:r.bgCard,border:`1px solid ${r.border}`},children:e.jsxs(v,{children:[e.jsx(l,{variant:"overline",sx:{color:r.textSecondary,letterSpacing:2},children:"Total Months"}),e.jsx(l,{variant:"h3",sx:{color:r.accent,fontWeight:800},children:H.length-1})]})})})]}),e.jsx(l,{variant:"overline",sx:{color:r.accent,letterSpacing:2,fontWeight:600,mb:2,display:"block"},children:"MATCH HISTORY"}),e.jsx(ne,{component:K,sx:{bgcolor:r.bgCard,border:`1px solid ${r.border}`},children:e.jsxs(ce,{children:[e.jsx(ie,{children:e.jsxs(D,{sx:{bgcolor:r.bgDark},children:[e.jsx(x,{sx:{color:r.textSecondary},children:"Date"}),e.jsx(x,{sx:{color:r.textSecondary},children:"Teams"}),e.jsx(x,{sx:{color:r.textSecondary},children:"Map"}),e.jsx(x,{sx:{color:r.textSecondary},children:"Favorite"}),e.jsx(x,{sx:{color:r.textSecondary},children:"Demo"})]})}),e.jsx(le,{children:m.map(s=>{var h;const a=de(s.map),t=String(s.matchid),d=T.includes(t),i=$[t]||{count:0,users:[]};return e.jsxs(D,{onClick:()=>z(s),sx:{cursor:"pointer",position:"relative",height:80,backgroundImage:a?`linear-gradient(to right, rgba(13,13,13,0.95) 0%, rgba(13,13,13,0.85) 40%, rgba(26,26,26,0.6) 100%), url(${a})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat","&:hover":{backgroundImage:a?`linear-gradient(to right, rgba(37,37,37,0.9) 0%, rgba(37,37,37,0.7) 40%, rgba(37,37,37,0.4) 100%), url(${a})`:"none",bgcolor:a?"transparent":r.bgHover,transform:"scale(1.01)"},transition:"all 0.3s ease",borderBottom:`1px solid ${r.border}`},children:[e.jsx(x,{sx:{color:r.textPrimary},children:s.date}),e.jsx(x,{sx:{color:r.textPrimary,fontWeight:600},children:R(s.url)}),e.jsx(x,{children:e.jsx(l,{sx:{color:r.accent,fontWeight:700,textTransform:"uppercase",letterSpacing:1},children:(h=s.map)==null?void 0:h.replace("de_","").replace("cs_","")})}),e.jsx(x,{onClick:c=>c.stopPropagation(),children:e.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(_,{title:n?d?"Remove from favorites":"Add to favorites":"Login to save favorites",children:e.jsx("span",{children:e.jsx(Y,{onClick:c=>w(c,t),disabled:!n,size:"small",sx:{color:d?"#ef4444":r.textSecondary,bgcolor:d?"rgba(239,68,68,0.15)":"transparent","&:hover":{color:"#ef4444",bgcolor:"rgba(239,68,68,0.2)"}},children:d?e.jsx(X,{}):e.jsx(Z,{})})})}),i.count>0&&e.jsx(_,{title:i.users.map(c=>c.name||c.username).join(", "),arrow:!0,children:e.jsx(q,{size:"small",label:i.count,sx:{bgcolor:d?"rgba(239,68,68,0.2)":`${r.accent}20`,color:d?"#ef4444":r.accent,fontWeight:600,cursor:"pointer",minWidth:28}})})]})}),e.jsx(x,{children:e.jsx(I,{variant:"contained",size:"small",href:s.demo_url,download:!0,onClick:B,sx:{bgcolor:r.accent,"&:hover":{bgcolor:"#ff7c3c"}},children:"Download"})})]},s.matchid)})})]})}),e.jsxs(ee,{open:W,onClose:M,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{bgcolor:r.bgCard,border:`1px solid ${r.border}`}},children:[e.jsx(re,{sx:{color:r.accent,textTransform:"uppercase",letterSpacing:2},children:"Match Details"}),e.jsx(se,{children:p?e.jsx(te,{matchId:p.matchid,url:p.url}):e.jsx(l,{variant:"body1",sx:{color:r.textSecondary},children:"Loading match details..."})}),e.jsx(ae,{sx:{borderTop:`1px solid ${r.border}`},children:e.jsx(I,{onClick:M,sx:{color:r.accent},children:"Close"})})]})]})})};export{ke as default};
